<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Flight Search</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 40px auto;
    }
    button {
      padding: 8px 12px;
      margin-top: 10px;
      cursor: pointer;
    }
    select {
      padding: 6px;
      width: 100%;
    }
    .route {
      margin-bottom: 15px;
    }
  </style>
</head>

<body>

<h2>Flight Search</h2>

<label for="airline">Choose an airline:</label><br><br>
<select id="airline"></select>

<br><br>
<button onclick="searchFlights()">Search</button>

<div id="results" style="margin-top:20px;"></div>

<script>
async function loadAirlines() {
  const response = await fetch("/api/search");
  const data = await response.json();

  const select = document.getElementById("airline");
  select.innerHTML = "";

  data.airlines.forEach(airline => {
    const option = document.createElement("option");
    option.value = airline;
    option.textContent = airline;
    select.appendChild(option);
  });
}

async function searchFlights() {
  const airline = document.getElementById("airline").value;
  const resultsDiv = document.getElementById("results");

  resultsDiv.innerHTML = "Loading...";

  const response = await fetch("/api/search?q=" + encodeURIComponent(airline));
  const data = await response.json();

  if (!data.routes || data.routes.length === 0) {
    resultsDiv.innerHTML = "No routes found.";
    return;
  }

  let html = `<h3>${data.airline} routes from Glasgow</h3>`;

  data.routes.forEach(route => {
    html += `
      <div class="route">
        <strong>${route.from} â†’ ${route.to}</strong><br>
        Days: ${route.days.join(", ")}
      </div>
    `;
  });

  resultsDiv.innerHTML = html;
}

window.onload = loadAirlines;
</script>

</body>
</html>

