<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Flights from Glasgow</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 40px auto;
    }
    select, button {
      padding: 8px;
      width: 100%;
      margin-top: 10px;
    }
    .result {
      margin-top: 20px;
    }
  </style>
</head>

<body>

<h2>Flights from Glasgow</h2>

<p><strong>From:</strong> Glasgow</p>

<label for="destination">Destination</label>
<select id="destination">
  <option value="">Loading destinations...</option>
</select>

<label for="day">Day of week</label>
<select id="day">
  <option value="">Select a day</option>
  <option>Monday</option>
  <option>Tuesday</option>
  <option>Wednesday</option>
  <option>Thursday</option>
  <option>Friday</option>
  <option>Saturday</option>
  <option>Sunday</option>
</select>

<button onclick="findAirlines()">Show airlines</button>

<div id="results" class="result"></div>

<script>
let flights = [];

async function loadData() {
  const response = await fetch("/api/search?all=true");
  const data = await response.json();
  flights = data.flights;

  const destinations = [...new Set(
    flights
      .filter(f => f.from === "Glasgow")
      .map(f => f.to)
  )].sort();

  const destinationSelect = document.getElementById("destination");
  destinationSelect.innerHTML = '<option value="">Select destination</option>';

  destinations.forEach(dest => {
    const option = document.createElement("option");
    option.value = dest;
    option.textContent = dest;
    destinationSelect.appendChild(option);
  });
}

function findAirlines() {
  const destination = document.getElementById("destination").value;
  const day = document.getElementById("day").value;
  const resultsDiv = document.getElementById("results");

  if (!destination || !day) {
    resultsDiv.innerHTML = "Please select both a destination and a day.";
    return;
  }

  const matches = flights.filter(f =>
    f.from === "Glasgow" &&
    f.to === destination &&
    f.days.includes(day)
  );

  if (matches.length === 0) {
    resultsDiv.innerHTML = `No flights to ${destination} on ${day}.`;
    return;
  }

  const airlines = [...new Set(matches.map(m => m.airline))];

  let html = `<h3>Airlines flying to ${destination} on ${day}</h3><ul>`;
  airlines.forEach(a => {
    html += `<li>${a}</li>`;
  });
  html += "</ul>";

  resultsDiv.innerHTML = html;
}

window.onload = loadData;
</script>

</body>
</html>


